@tailwind base;
@tailwind components;
@tailwind utilities;

/* 自定义样式 */
.App {
  text-align: left;
}

/* Markdown内容样式优化 */
.prose {
  max-width: none !important;
  font-size: 16px !important;
}

.prose h1 {
  @apply text-4xl font-bold text-gray-900 dark:text-gray-100 mb-4 pb-2 border-b border-gray-200 dark:border-gray-700;
}

.prose h2 {
  @apply text-3xl font-semibold text-gray-800 dark:text-gray-200 mb-3 mt-8;
}

.prose h3 {
  @apply text-2xl font-medium text-gray-700 dark:text-gray-300 mb-2 mt-6;
}

.prose p {
  @apply text-gray-600 dark:text-gray-300 mb-4 leading-relaxed;
  font-size: 16px !important;
  line-height: 1.7 !important;
}

.prose ul {
  @apply list-disc list-inside mb-4 space-y-1 text-gray-600 dark:text-gray-300;
  font-size: 16px !important;
}

.prose ol {
  @apply list-decimal list-inside mb-4 space-y-1 text-gray-600 dark:text-gray-300;
  font-size: 16px !important;
}

.prose blockquote {
  @apply border-l-4 border-blue-500 dark:border-blue-400 pl-4 italic text-gray-700 dark:text-gray-300 mb-4 bg-blue-50 dark:bg-blue-900/20 py-2;
  font-size: 16px !important;
}

.prose code {
  @apply bg-gray-100 dark:bg-gray-700 px-1 py-0.5 rounded text-sm font-mono text-gray-800 dark:text-gray-200;
}

.prose pre {
  @apply bg-gray-100 dark:bg-gray-800 p-4 rounded-lg overflow-x-auto mb-4;
}

.prose pre code {
  @apply bg-transparent px-0 py-0;
}

/* Mermaid图表样式 */
.mermaid {
  @apply w-full h-auto;
}

/* 暗模式下的Mermaid图表样式 */
:root.dark .mermaid {
  filter: brightness(0.8) contrast(1.2);
}

/* Mermaid节点高亮样式 - 只高亮边框，不改变填充色 */
.mermaid svg g.mermaid-highlighted-node > rect,
.mermaid svg g.mermaid-highlighted-node > circle,
.mermaid svg g.mermaid-highlighted-node > ellipse,
.mermaid svg g.mermaid-highlighted-node > polygon,
.mermaid svg .mermaid-highlighted-node rect,
.mermaid svg .mermaid-highlighted-node circle,
.mermaid svg .mermaid-highlighted-node ellipse,
.mermaid svg .mermaid-highlighted-node polygon {
  stroke: #FB923C !important;
  stroke-width: 3px !important;
  filter: drop-shadow(0 0 8px rgba(251, 146, 60, 0.6)) drop-shadow(0 0 16px rgba(251, 146, 60, 0.3)) !important;
  /* 不改变填充色，保持原有颜色 */
}

/* 暗模式下的Mermaid高亮样式 */
:root.dark .mermaid svg g.mermaid-highlighted-node > rect,
:root.dark .mermaid svg g.mermaid-highlighted-node > circle,
:root.dark .mermaid svg g.mermaid-highlighted-node > ellipse,
:root.dark .mermaid svg g.mermaid-highlighted-node > polygon,
:root.dark .mermaid svg .mermaid-highlighted-node rect,
:root.dark .mermaid svg .mermaid-highlighted-node circle,
:root.dark .mermaid svg .mermaid-highlighted-node ellipse,
:root.dark .mermaid svg .mermaid-highlighted-node polygon {
  stroke: #FED7AA !important;
  stroke-width: 3px !important;
  filter: drop-shadow(0 0 8px rgba(253, 215, 170, 0.8)) drop-shadow(0 0 16px rgba(253, 215, 170, 0.4)) !important;
}

/* 确保连接线不受高亮影响 */
.mermaid svg g.mermaid-highlighted-node > path,
.mermaid svg g.mermaid-highlighted-node > line,
.mermaid svg .mermaid-highlighted-node path,
.mermaid svg .mermaid-highlighted-node line {
  stroke: #9ca3af !important;
  stroke-width: 1.5px !important;
  fill: none !important;
  filter: none !important;
}

/* 暗模式下的连接线 */
:root.dark .mermaid svg g.mermaid-highlighted-node > path,
:root.dark .mermaid svg g.mermaid-highlighted-node > line,
:root.dark .mermaid svg .mermaid-highlighted-node path,
:root.dark .mermaid svg .mermaid-highlighted-node line {
  stroke: #6b7280 !important;
}

/* React Flow节点高亮样式 */
.react-flow__node.highlighted-node {
  border: 3px solid #FB923C !important;
  box-shadow: 0 0 15px rgba(251, 146, 60, 0.6), 0 0 30px rgba(251, 146, 60, 0.3) !important;
  z-index: 1000 !important;
}

/* 暗模式下的React Flow节点高亮 */
:root.dark .react-flow__node.highlighted-node {
  border: 3px solid #FED7AA !important;
  box-shadow: 0 0 15px rgba(253, 215, 170, 0.8), 0 0 30px rgba(253, 215, 170, 0.4) !important;
}

/* 活跃文本块样式 - 静止状态，无动画 */
.content-block {
  border-left: 4px solid transparent;
}

.content-block.active {
  border-left-color: #FB923C !important;
  /* 不设置任何其他样式，确保只有边框颜色改变 */
}

/* 暗模式下的活跃文本块 */
:root.dark .content-block.active {
  border-left-color: #FED7AA !important;
}

/* 确保文本内容不受Mermaid节点样式影响 */
.content-block,
.content-block *,
.prose,
.prose * {
  filter: none !important;
}

/* 强制确保活跃内容块内的所有元素都不受filter影响 */
.content-block.active,
.content-block.active *,
.content-block.active p,
.content-block.active h1,
.content-block.active h2,
.content-block.active h3,
.content-block.active h4,
.content-block.active h5,
.content-block.active h6,
.content-block.active span,
.content-block.active div {
  color: inherit !important;
  background-color: transparent !important;
  background: none !important;
  filter: none !important;
}

/* 防止选择状态影响显示 */
.content-block.active::selection,
.content-block.active *::selection {
  background-color: rgba(59, 130, 246, 0.2) !important;
  color: inherit !important;
}

/* 章节高亮样式 - 静止状态，无动画 */
.section-highlighted {
  border-left: 4px solid #FB923C;
  background-color: rgba(251, 146, 60, 0.05) !important;
  transform: translateX(2px);
}

/* 暗模式下的章节高亮 */
:root.dark .section-highlighted {
  border-left-color: #FED7AA;
  background-color: rgba(253, 215, 170, 0.1) !important;
}

/* 普通模式下的chunk-section高亮效果 */
.chunk-section.section-highlighted {
  border-left-color: #FB923C !important;
  background-color: rgba(251, 146, 60, 0.05) !important;
  transform: translateX(2px);
  box-shadow: 0 2px 8px rgba(251, 146, 60, 0.1);
}

:root.dark .chunk-section.section-highlighted {
  border-left-color: #FED7AA !important;
  background-color: rgba(253, 215, 170, 0.1) !important;
  box-shadow: 0 2px 8px rgba(253, 215, 170, 0.15);
}

/* chunk-section的基础样式 */
.chunk-section {
  padding: 12px 16px;
  border-radius: 6px;
  margin-bottom: 16px;
}

.chunk-section:hover {
  background-color: rgba(249, 250, 251, 0.5);
}

:root.dark .chunk-section:hover {
  background-color: rgba(31, 41, 55, 0.5);
}

/* 滚动条样式 */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-track {
  @apply bg-gray-100 dark:bg-gray-800;
}

::-webkit-scrollbar-thumb {
  @apply bg-gray-300 dark:bg-gray-600 rounded;
}

::-webkit-scrollbar-thumb:hover {
  @apply bg-gray-400 dark:bg-gray-500;
}

/* 拖拽上传区域样式 */
.upload-area {
  transition: all 0.2s ease-in-out;
}

.upload-area:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

/* 暗模式下的拖拽上传区域 */
:root.dark .upload-area:hover {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

/* 响应式调整 */
@media (max-width: 768px) {
  .prose {
    font-size: 15px !important;
  }
  
  .prose h1 {
    @apply text-3xl;
  }
  
  .prose h2 {
    @apply text-2xl;
  }
  
  .prose h3 {
    @apply text-xl;
  }
  
  .prose p {
    font-size: 15px !important;
  }
}

/* 加载动画 */
@keyframes pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
}

.pulse {
  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

/* 渐入动画 */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.fade-in {
  animation: fadeIn 0.3s ease-out;
}

/* 工具提示样式 */
.tooltip {
  @apply invisible absolute z-10 py-2 px-3 text-sm font-medium text-white bg-gray-900 dark:bg-gray-700 rounded-lg shadow-sm opacity-0 transition-opacity duration-300;
}

.tooltip-trigger:hover .tooltip {
  @apply visible opacity-100;
}

/* 暗模式下的Toast通知样式 */
:root {
  --toast-bg: #363636;
  --toast-color: #fff;
}

:root.dark {
  --toast-bg: #374151;
  --toast-color: #f9fafb;
}

/* 移除不需要的样式 */
/* .content-block-highlighted 和其他背景高亮样式已删除 */

/* 
高亮样式说明：
- 亮模式：使用#FB923C (橙色-400)作为高亮色
- 暗模式：使用#FED7AA (橙色-200)作为高亮色，更适合暗色背景
- Mermaid节点：仅高亮边框和添加发光效果，不改变填充色
- 文本块：仅左侧边框高亮，不改变背景和文字颜色
*/

/* 语义块高亮样式 - 基于AI生成的语义分析 - 只有左边框，不改变格式 */
.semantic-block-highlighted {
  border-left: 4px solid #FB923C !important;
}

/* 暗模式下的语义块高亮 */
:root.dark .semantic-block-highlighted {
  border-left-color: #FED7AA !important;
}

/* 段落级语义高亮样式 - 固定边框，不移动文本 */
.semantic-paragraph-highlighted {
  border-left: 4px solid #FB923C !important;
  /* 确保原始布局不变，避免文本移动 */
  margin-left: 0 !important;
  padding-left: 16px; /* 增加内边距而不是外边距 */
  box-sizing: border-box;
}

/* 暗模式下的段落级高亮 */
:root.dark .semantic-paragraph-highlighted {
  border-left-color: #FED7AA !important;
}

/* 段落块的基础样式 - 移除hover效果 */
.paragraph-block, .content-block {
  /* 移除所有hover效果，确保没有交互式样式 */
  border-left: 4px solid transparent; /* 预留边框空间，避免高亮时布局变化 */
  padding-left: 16px;
  box-sizing: border-box;
  transition: border-left-color 0.2s ease; /* 只过渡边框颜色 */
}

/* 确保语义高亮样式优先级更高 */
.semantic-block-highlighted,
.semantic-paragraph-highlighted {
  position: relative;
  z-index: 10;
}

/* 语义块组合高亮 - 当多个段落属于同一语义块时 */
.semantic-group-highlighted {
  background: linear-gradient(to right, 
    rgba(59, 130, 246, 0.05), 
    rgba(59, 130, 246, 0.1), 
    rgba(59, 130, 246, 0.05)
  ) !important;
  border-left: 4px solid #3b82f6 !important;
  border-radius: 8px;
  padding: 12px 16px;
  margin: 8px 0;
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.1);
}

:root.dark .semantic-group-highlighted {
  background: linear-gradient(to right, 
    rgba(59, 130, 246, 0.08), 
    rgba(59, 130, 246, 0.15), 
    rgba(59, 130, 246, 0.08)
  ) !important;
  border-left-color: #60a5fa !important;
  box-shadow: 0 4px 12px rgba(96, 165, 250, 0.15);
} 